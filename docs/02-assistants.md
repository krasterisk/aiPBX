# 🤖 Ассистенты — полное руководство

> Ассистент — это ваш виртуальный сотрудник. Он отвечает на звонки, ведёт диалог с клиентами и выполняет действия. В этом разделе вы узнаете, как создать, настроить и опубликовать идеального ассистента для вашего бизнеса.

---

## Содержание

1. [Создание ассистента](#создание-ассистента)
2. [Форма настройки — обзор](#форма-настройки--обзор)
3. [Инструкция (промпт) — сердце ассистента](#инструкция-промпт--сердце-ассистента)
4. [Основные настройки](#основные-настройки)
5. [Модель ИИ — какую выбрать?](#модель-ии--какую-выбрать)
6. [Голос — как звучит ваш ассистент](#голос--как-звучит-ваш-ассистент)
7. [Параметры модели и VAD](#параметры-модели-и-vad)
8. [Расширенные настройки (для администраторов)](#расширенные-настройки-для-администраторов)
9. [Гайд по написанию промптов](#гайд-по-написанию-промптов)
10. [Готовые примеры промптов](#готовые-примеры-промптов)

---

## Создание ассистента

На странице **«Ассистенты»** вы увидите список всех ваших ассистентов. Нажмите кнопку **«＋»** в правом верхнем углу, чтобы создать нового.

```
┌──────────────────────────────────────────────────────────────┐
│  🤖 Ассистенты                                    ┌────┐    │
│                                                    │ ＋  │    │
│  ┌──────────────────────────────────────────────┐ └────┘    │
│  │  🟢 Бот поддержки клиентов                   │           │
│  │  gpt-4o-realtime • alloy • 3 функции         │           │
│  │  📝 Основной бот для обработки входящих      │           │
│  └──────────────────────────────────────────────┘           │
│                                                              │
│  ┌──────────────────────────────────────────────┐           │
│  │  🟡 Оператор пиццерии                        │           │
│  │  gpt-4o-realtime • shimmer • 2 функции       │           │
│  │  📝 Принимает заказы и уточняет адрес        │           │
│  └──────────────────────────────────────────────┘           │
└──────────────────────────────────────────────────────────────┘
```

Также при создании можно использовать **готовый шаблон**. Если в URL передан параметр `?template=repair` (например, через онбординг), система автоматически загрузит промпт шаблона.

---

## Форма настройки — обзор

Форма ассистента разделена на **две колонки**:

```
┌─────────────────────────────────────────────────────────────────────────┐
│                                                                         │
│  ┌──── Левая колонка (60%) ────┐  ┌── Правая колонка (40%) ──────────┐ │
│  │                              │  │                                  │ │
│  │  📝 ИНСТРУКЦИЯ               │  │  ⚙️ ОСНОВНЫЕ НАСТРОЙКИ           │ │
│  │                              │  │  ┌──────────────────────────┐   │ │
│  │  ┌──────────────────────┐   │  │  │ Наименование             │   │ │
│  │  │ Ты — оператор        │   │  │  │ ┌────────────────────┐   │   │ │
│  │  │ сервисного центра    │   │  │  │ │ Бот поддержки      │   │   │ │
│  │  │ «ТехноМастер».       │   │  │  │ └────────────────────┘   │   │ │
│  │  │                      │   │  │  │                          │   │ │
│  │  │ Твоя задача:         │   │  │  │ Модель                   │   │ │
│  │  │ 1. Приветствовать    │   │  │  │ ┌────────────────────┐   │   │ │
│  │  │    клиента           │   │  │  │ │ gpt-4o-realtime  ▾ │   │   │ │
│  │  │ 2. Выяснить проблему │   │  │  │ └────────────────────┘   │   │ │
│  │  │ 3. Записать данные   │   │  │  │                          │   │ │
│  │  │ ...                  │   │  │  │ Голос                    │   │ │
│  │  │                      │   │  │  │ ┌────────────────────┐   │   │ │
│  │  └──────────────────────┘   │  │  │ │ alloy            ▾ │   │   │ │
│  │                              │  │  │ └────────────────────┘   │   │ │
│  │  [✨ Сгенерировать]         │  │  │                          │   │ │
│  │                              │  │  │ Функции                  │   │ │
│  │                              │  │  │ ┌────────────────────┐   │   │ │
│  │                              │  │  │ │ book_appointment ✕│   │   │ │
│  │                              │  │  │ │ check_status   ✕  │   │   │ │
│  │                              │  │  │ └────────────────────┘   │   │ │
│  │                              │  │  │                          │   │ │
│  │                              │  │  │ ☑ Аналитика             │   │ │
│  │                              │  │  │                          │   │ │
│  │                              │  │  │ Комментарий              │   │ │
│  │                              │  │  │ ┌────────────────────┐   │   │ │
│  │                              │  │  │ │ Для отдела продаж │   │   │ │
│  │                              │  │  │ └────────────────────┘   │   │ │
│  │                              │  │  └──────────────────────────┘   │ │
│  │                              │  │                                  │ │
│  │                              │  │  🎯 ПАРАМЕТРЫ МОДЕЛИ            │ │
│  │                              │  │  ┌──────────────────────────┐   │ │
│  │                              │  │  │ Температура     0.8      │   │ │
│  │                              │  │  │ ──────●─────────         │   │ │
│  │                              │  │  │                          │   │ │
│  │                              │  │  │ Время простоя   30 сек   │   │ │
│  │                              │  │  │ ─────────────●──         │   │ │
│  │                              │  │  │                          │   │ │
│  │                              │  │  │ Порог VAD       0.5      │   │ │
│  │                              │  │  │ ──────●─────────         │   │ │
│  │                              │  │  └──────────────────────────┘   │ │
│  └──────────────────────────────┘  └──────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────┘
```

На мобильных устройствах колонки располагаются вертикально — сначала инструкция, затем настройки.

---

## Инструкция (промпт) — сердце ассистента

**Инструкция** (она же «системный промпт») — это самое важное поле при настройке ассистента. Именно этот текст определяет, КАК ваш ассистент будет вести диалог.

### Что это и зачем?

Представьте, что вы нанимаете нового сотрудника. Вы не просто говорите «работай» — вы даёте ему **должностную инструкцию**: кто он, чем занимается, какие задачи выполняет, чего делать нельзя. Промпт — это та самая «должностная инструкция» для вашего ИИ-оператора.

Модель ИИ получает этот текст **перед каждым разговором** и строит всё своё поведение на его основе.

### Кнопка «Сгенерировать»

Не знаете, что написать? Нажмите кнопку **✨ Сгенерировать**:

```
┌──────────────────────────────────────────────────────┐
│  ✨ Генерация промпта                                │
│                                                      │
│  Опишите задачу в свободной форме:                   │
│  ┌──────────────────────────────────────────────┐    │
│  │ Оператор пиццерии, принимает заказы,         │    │
│  │ уточняет адрес и размер пиццы, предлагает    │    │
│  │ напитки, называет итоговую сумму             │    │
│  └──────────────────────────────────────────────┘    │
│                                                      │
│  ┌──────────────────────────────────────────────┐    │
│  │         ✨ Сгенерировать промпт               │    │
│  └──────────────────────────────────────────────┘    │
└──────────────────────────────────────────────────────┘
```

ИИ преобразует ваше описание в профессиональный, структурированный промпт с ролью, задачами, ограничениями и тоном.

---

## Основные настройки

### Таблица полей основной карточки

| Поле | Описание | Пример |
|------|----------|--------|
| **Наименование** | Имя ассистента для внутренней идентификации. Отображается в списке ассистентов, отчётах и фильтрах. Выбирайте понятное имя. | `Бот поддержки клиентов` |
| **Модель** | Языковая модель ИИ. От неё зависит качество понимания, скорость ответа и стоимость. Подробнее ниже. | `gpt-4o-realtime-preview` |
| **Голос** | Голосовая персона — как ассистент звучит. Разные голоса отличаются тоном, полом и акцентом. | `alloy`, `shimmer`, `echo` |
| **Функции** | Список подключённых инструментов (функций). Ассистент сможет вызывать эти функции во время разговора. | `book_appointment`, `check_status` |
| **MCP Серверы** | Подключённые MCP серверы (Telegram, Gmail и др.). Позволяют ассистенту взаимодействовать с внешними сервисами. | `Telegram Bot`, `Google Calendar` |
| **Аналитика** | Если включена — после каждого звонка ИИ автоматически генерирует аналитику: тональность разговора, краткое резюме, тему обращения. | `Включено ☑` |
| **Комментарий** | Внутренняя заметка для вашей команды. Не влияет на поведение ассистента, но помогает организовать работу. | `Тестовый, не публиковать` |

---

## Модель ИИ — какую выбрать?

Модель — это «мозг» вашего ассистента. От выбора модели зависит, насколько умным, быстрым и дорогим будет ваш оператор.

### Доступные модели

| Модель | Плюсы | Минусы | Для кого |
|--------|-------|--------|----------|
| **GPT-4o Realtime** | Глубокое понимание контекста, сложные диалоги, нативный голосовой ввод/вывод | Дороже, чуть медленнее | Сложные сценарии: медицина, юридика, финансы |
| **GPT-4o Mini** | Хороший баланс цена/качество | Менее глубокое понимание | Стандартные задачи: записи, заказы |
| **Qwen Realtime** | Быстрее, значительно дешевле, хорошая поддержка CJK | Менее «творческий» | Простые задачи, высокий объём звонков |

### Как выбрать?

```
Ваш сценарий сложный?
  ├── Да (медицина, юридика, техподдержка) → GPT-4o Realtime
  └── Нет (записи, заказы, FAQ)
        ├── Важна экономия? → Qwen Realtime
        └── Важно качество? → GPT-4o Mini / Realtime
```

> 💡 **Совет:** Начните с GPT-4o Realtime для отладки промпта, затем переключитесь на более дешёвую модель, если качество устраивает.

### Важно: смена модели сбрасывает голос

При смене модели поле «Голос» очищается, т.к. разные модели поддерживают разные голоса. Выберите голос заново после смены модели.

---

## Голос — как звучит ваш ассистент

Голос определяет «личность» вашего ассистента при разговоре. Это **не робот** — голоса звучат естественно, с интонациями и паузами.

### Как выбрать голос?

Набор доступных голосов зависит от выбранной модели. Вот ориентиры:

| Голос | Характеристика | Подходит для |
|-------|---------------|-------------|
| **alloy** | Нейтральный, универсальный | Техподдержка, деловые звонки |
| **echo** | Глубокий, спокойный | Банки, юридические услуги |
| **shimmer** | Мягкий, приветливый | Салоны красоты, клиники |
| **ash** | Энергичный, молодой | Доставка, развлечения |
| **coral** | Тёплый, женский | Ресепшн, гостиницы |

> 🎧 **Совет:** Протестируйте несколько голосов в Песочнице — там можно менять голос и сразу слышать разницу.

---

## Параметры модели и VAD

Эти настройки влияют на «характер» ассистента и качество распознавания речи.

### Карточка параметров

```
┌──────────────────────────────────────────────────────┐
│  🎯 Параметры модели                                 │
│                                                      │
│  Температура                               0.8       │
│  ├─────────────────●─────────────────────┤            │
│  0.6 (точные)      ↑        1.2 (творческие)         │
│                  баланс                               │
│                                                      │
│  Время простоя (сек)                       30        │
│  ├──────────────────────────────●─────────┤           │
│  5                                         120       │
│                                                      │
│  ─── VAD (обнаружение голоса) ───                    │
│                                                      │
│  Порог обнаружения речи                    0.5       │
│  ├─────────────────●─────────────────────┤            │
│  0.0 (чувствительный)     1.0 (строгий)              │
│                                                      │
│  Длительность включаемого аудио (мс)       300       │
│  ├──────●────────────────────────────────┤            │
│                                                      │
│  Длительность тишины (мс)                  500       │
│  ├───────────●───────────────────────────┤            │
└──────────────────────────────────────────────────────┘
```

### Подробное описание каждого параметра

| Параметр | Что делает | Рекомендация | Диапазон |
|----------|-----------|--------------|----------|
| **Температура** | Контролирует «креативность» ответов. Низкая = точные, предсказуемые ответы. Высокая = разнообразные, но менее стабильные. | **0.8** для большинства задач. 0.6 для медицины/финансов, 1.0 для творческих задач | 0.6 — 1.2 |
| **Время простоя** | Через сколько секунд молчания сессия автоматически завершится. Если клиент не говорит 30 секунд — разговор окончен. | **30 сек** для обычных звонков, 60+ для сложных консультаций | 5 — 120 |
| **Порог VAD** | Минимальная «уверенность» системы, что человек начал говорить. Высокий порог = меньше ложных срабатываний (фоновый шум не распознаётся как речь). | **0.5** — золотая середина | 0.0 — 1.0 |
| **Включаемое аудио** | Сколько миллисекунд аудио ДО момента срабатывания VAD включить в распознавание. Помогает не «проглотить» начало фразы клиента. | **300 мс** | 0 — 1000 |
| **Длительность тишины** | Сколько миллисекунд тишины ждать после окончания речи, чтобы понять: клиент закончил говорить. Слишком мало — ассистент «перебивает». Слишком много — неестественные паузы. | **500 мс** | 100 — 2000 |

### Что такое VAD и зачем он нужен?

**VAD** (Voice Activity Detection) — это технология, которая определяет, когда человек **начинает говорить** и когда **замолкает**. Без VAD ассистент не знал бы, когда слушать, а когда отвечать.

Представьте разговор двух людей: один говорит, второй слушает и ждёт паузу, чтобы ответить. VAD делает то же самое — слушает поток аудио и определяет моменты речи и тишины.

**Пример проблем с плохо настроенным VAD:**
- Порог слишком низкий → фоновый шум (телевизор, улица) воспринимается как речь → ассистент «перебивает»
- Порог слишком высокий → тихую речь не слышит → ассистент не реагирует
- Тишина слишком короткая → ассистент начинает отвечать, пока клиент ещё думает
- Тишина слишком длинная → неестественные паузы, клиент думает что связь оборвалась

---

## Расширенные настройки (для администраторов)

> ⚠️ Эти настройки доступны **только администраторам** системы. Изменение без понимания может ухудшить качество диалогов.

```
┌──────────────────────────────────────────────────────┐
│  🔧 Расширенные настройки (только для админов)       │
│                                                      │
│  Макс. токенов ответа        ┌──────────────┐        │
│                               │ 4096         │        │
│                               └──────────────┘        │
│                                                      │
│  Модель STT                   ┌──────────────┐        │
│                               │ whisper-1  ▾ │        │
│                               └──────────────┘        │
│                                                      │
│  Язык распознавания           ┌──────────────┐        │
│                               │ ru         ▾ │        │
│                               └──────────────┘        │
│                                                      │
│  Модель TTS                   ┌──────────────┐        │
│                               │ tts-1      ▾ │        │
│                               └──────────────┘        │
│                                                      │
│  Аудио формат (вход)          ┌──────────────┐        │
│                               │ g711_alaw  ▾ │        │
│                               └──────────────┘        │
│                                                      │
│  Аудио формат (выход)         ┌──────────────┐        │
│                               │ g711_alaw  ▾ │        │
│                               └──────────────┘        │
│                                                      │
│  Тип VAD                      ┌──────────────┐        │
│                               │ server_vad ▾ │        │
│                               └──────────────┘        │
│                                                      │
│  ☑ Шумоподавление                                    │
└──────────────────────────────────────────────────────┘
```

| Параметр | Описание |
|----------|----------|
| **Макс. токенов ответа** | Ограничивает длину одного ответа ассистента. 4096 — стандарт |
| **Модель STT** | Движок Speech-to-Text для преобразования голоса клиента в текст |
| **Язык распознавания** | Ожидаемый язык входящей речи. Улучшает точность для конкретного языка |
| **Модель TTS** | Движок Text-to-Speech для озвучивания ответов ассистента |
| **Аудио формат** | Кодек входного/выходного аудио. g711_alaw для SIP, pcm16 для WebRTC |
| **Тип VAD** | `server_vad` — стандартный. `semantic_vad` — продвинутый, ИИ понимает контекст |
| **Семантическая чувствительность** | При semantic_vad: Low → ждёт дольше, High → отвечает быстрее |
| **Шумоподавление** | Фильтрация фонового шума. Рекомендуется включить |

---

## Гайд по написанию промптов

### Структура идеального промпта

Каждый хороший промпт содержит **5 элементов**:

```
┌──────────────────────────────────────────────────────┐
│                                                      │
│  1️⃣ РОЛЬ          Кто ты?                            │
│                    «Ты — оператор пиццерии»          │
│                                                      │
│  2️⃣ КОНТЕКСТ      Где ты работаешь?                  │
│                    «Пиццерия "Белла", Москва»        │
│                                                      │
│  3️⃣ ЗАДАЧИ        Что ты делаешь?                    │
│                    Пронумерованный список             │
│                                                      │
│  4️⃣ ОГРАНИЧЕНИЯ   Чего НЕ делаешь?                   │
│                    Чёткие границы компетенции         │
│                                                      │
│  5️⃣ ТОН           Как ты общаешься?                  │
│                    Формально/дружелюбно               │
│                                                      │
└──────────────────────────────────────────────────────┘
```

### 10 правил хорошего промпта

1. **Будьте конкретны.** Вместо «помогай клиентам» напишите «помоги записаться на приём, узнав дату, время и имя»
2. **Нумеруйте задачи.** Это помогает модели выполнять их последовательно
3. **Указывайте ограничения.** Ассистент без ограничений ответит на ЛЮБОЙ вопрос — даже не по теме
4. **Упоминайте функции.** Если подключены функции (book_appointment и т.д.), укажите их по имени в промпте
5. **Определите тон.** «На вы» или «на ты»? Формально или дружелюбно?
6. **Укажите приветствие.** Как ассистент начнёт разговор? «Здравствуйте, пиццерия Белла!»
7. **Пропишите сценарий «не знаю».** Что делать, если вопрос не по теме?
8. **Добавьте данные.** Адрес, часы работы, цены — всё, что может понадобиться
9. **Укажите когда завершать.** «После записи попрощайся и заверши звонок»
10. **Тестируйте и улучшайте.** Каждый промпт надо проверять в Песочнице

---

## Готовые примеры промптов

### Пример 1: Сервисный центр по ремонту техники

```
Ты — оператор сервисного центра по ремонту бытовой техники «ТехноМастер».

Твоя задача:
1. Приветствовать клиента и выяснить, какая техника вышла из строя.
2. Уточнить марку и модель устройства.
3. Узнать характер неисправности (не включается, шумит, протекает и т.д.).
4. Предложить удобное время для визита мастера.
5. Записать контактные данные клиента (имя, телефон, адрес).

Ограничения:
- Не называй стоимость ремонта — скажи, что мастер определит на месте.
- Если техника старше 15 лет, вежливо предложи рассмотреть покупку новой.
- Работай только с бытовой техникой. На другие вопросы — «Это не в моей компетенции».

Тон: дружелюбный, профессиональный. Обращайся на «вы».
```

### Пример 2: Пиццерия с доставкой

```
Ты — оператор пиццерии «Пицца Белла». Принимаешь заказы по телефону.

Твоя задача:
1. Приветствовать клиента.
2. Принять заказ: узнать какую пиццу, размер (25см / 30см / 35см), количество.
3. Предложить дополнительно: напитки, соусы, десерты.
4. Уточнить способ получения: доставка или самовывоз.
5. При доставке — узнать адрес, подъезд, этаж, домофон.
6. Назвать итоговую сумму и время ожидания.

Меню (используй функцию get_menu для актуального меню).

Ограничения:
- Минимальная сумма заказа на доставку — 500 руб.
- Радиус доставки — 5 км. Если адрес дальше, предложи самовывоз.
- Время доставки: 40-60 минут.

Тон: весёлый, энергичный. Обращайся на «ты».
```

### Пример 3: Стоматологическая клиника

```
Ты — администратор стоматологической клиники «Дентал Плюс».

Твоя задача:
1. Узнать, первичный это визит или повторный.
2. Уточнить причину обращения (боль, профилактика, отбеливание и т.д.).
3. Предложить свободные даты и время (используй функцию check_schedule).
4. Записать пациента (используй функцию book_appointment).
5. Напомнить о необходимости взять паспорт и полис ОМС.

Важно:
- Если пациент описывает острую боль — предложи ближайшее доступное время.
- Не ставь диагнозы и не давай медицинских рекомендаций.
- Если спрашивают о ценах — назови диапазон, уточни что точную стоимость
  определит врач.

Тон: спокойный, заботливый, профессиональный.
```

### Пример 4: Ресепшн отеля

```
Ты — ресепшн-бот отеля «Grand Palace Hotel».

Твоя задача:
1. Приветствовать гостя и узнать цель звонка.
2. Если бронирование — узнать даты заезда/выезда, количество гостей, тип номера.
3. Проверить доступность (используй функцию check_availability).
4. Озвучить стоимость за период и условия.
5. Оформить бронирование (используй функцию create_booking).

Типы номеров:
- Стандарт (от 4500 руб/ночь)
- Комфорт (от 6500 руб/ночь)
- Люкс (от 12000 руб/ночь)

Ограничения:
- Заезд с 14:00, выезд до 12:00.
- Дети до 7 лет — бесплатно на существующем месте.
- Отмена бронирования бесплатно за 48 часов.

Тон: элегантный, гостеприимный. Обращайся на «Вы».
```

### Пример 5: Техническая поддержка SaaS

```
Ты — специалист первой линии техподдержки SaaS-платформы «CloudBase».

Твоя задача:
1. Идентифицировать пользователя (запросить email аккаунта).
2. Узнать суть проблемы.
3. Попытаться решить типовые проблемы:
   - Не могу войти → предложить сброс пароля (функция reset_password).
   - Медленная работа → уточнить браузер, предложить очистить кеш.
   - Ошибка при оплате → проверить статус платежа (функция check_payment).
4. Если проблема нетиповая — создать тикет (функция create_ticket).

Ограничения:
- Не имеешь доступа к паролям пользователей.
- Не можешь отменять подписки — только переводить на отдел продаж.
- Время ответа тикета: до 24 часов в будни.

Тон: терпеливый, технически грамотный. Избегай сложных терминов.
```

---

*Предыдущий раздел: [🚀 Быстрый старт](./01-getting-started.md) • Следующий раздел: [🧩 Функции (Tools) →](./03-tools.md)*
